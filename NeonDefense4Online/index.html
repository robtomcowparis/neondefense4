<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>NEON DEFENSE</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <!-- ‚ïê‚ïê‚ïê Menu Overlay ‚ïê‚ïê‚ïê -->
    <div id="menuOverlay" class="overlay">
        <div class="scanlines"></div>
        <div class="menu-content">
            <h1 class="menu-title">NEON<br>DEFENSE</h1>
            <div class="menu-subtitle">INFINITE SURVIVAL</div>
            <div class="menu-divider"></div>
            <button id="btnStart" class="menu-btn pulse-btn">‚ñ∂ START GAME</button>
            <button id="btnHowToPlay" class="menu-btn menu-btn-help">? HOW TO PLAY</button>
            <div class="menu-keys">
                <div>1‚Äì5 Select Tower &nbsp;|&nbsp; LMB Place &nbsp;|&nbsp; RMB Cancel</div>
                <div>SPACE Send Early &nbsp;|&nbsp; F Fast Forward &nbsp;|&nbsp; ESC Pause</div>
            </div>
            <div class="menu-divider"></div>
            <div class="menu-section-title">GLOBAL LEADERBOARD</div>
            <div id="menuLeaderboard" class="leaderboard-table">
                <div class="lb-loading">Loading scores...</div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê How To Play Overlay ‚ïê‚ïê‚ïê -->
    <div id="howToPlayOverlay" class="overlay hidden">
        <div class="scanlines"></div>
        <div class="htp-content">
            <div class="htp-header">
                <h2 class="htp-title">HOW TO PLAY</h2>
                <button id="btnHtpClose" class="htp-close-btn">‚úï</button>
            </div>
            <div class="htp-scroll">

                <div class="htp-section">
                    <div class="htp-section-title">OBJECTIVE</div>
                    <p>Three enemy paths converge from the left side of the map. Build towers to destroy enemies before they reach the exit on the right. You start with <span class="htp-hl-gold">1,000 gold</span> and <span class="htp-hl-green">30 lives</span>. Lose all lives and it's game over. Survive as many waves as you can.</p>
                </div>

                <div class="htp-section">
                    <div class="htp-section-title">CONTROLS</div>
                    <div class="htp-controls-grid">
                        <span class="htp-key">1‚Äì5</span><span>Select tower type</span>
                        <span class="htp-key">LMB</span><span>Place tower / Select tower</span>
                        <span class="htp-key">RMB</span><span>Cancel placement</span>
                        <span class="htp-key">SPACE</span><span>Send next wave early (+bonus gold)</span>
                        <span class="htp-key">F</span><span>Fast forward (2√ó speed)</span>
                        <span class="htp-key">ESC</span><span>Pause / Resume</span>
                        <span class="htp-key">Q</span><span>Quit to menu (while paused)</span>
                    </div>
                </div>

                <div class="htp-section">
                    <div class="htp-section-title">TOWERS</div>
                    <p>Each tower can be upgraded twice (Lv1 ‚Üí Lv2 ‚Üí Lv3), then specialized into one of two unique branches. Towers take time to build (5‚Äì10s), so plan placements ahead of incoming waves. Towers have HP and can be damaged by Sappers ‚Äî click a placed tower to see its stats, repair, upgrade, sell, or (after branching) buy a shield.</p>
                    <div class="htp-tower-list">
                        <div class="htp-tower" style="--tw-c: var(--cyan);">
                            <div class="htp-tw-name">PULSE <span class="htp-tw-cost">100g</span></div>
                            <div class="htp-tw-desc">Rapid-fire energy bolts. Cheap, fast, bread-and-butter DPS.</div>
                            <div class="htp-tw-branches">‚§∑ Overclock (fire rate) ¬∑ Heavy Bolts (splash)</div>
                        </div>
                        <div class="htp-tower" style="--tw-c: var(--magenta);">
                            <div class="htp-tw-name">RAIL <span class="htp-tw-cost">150g</span></div>
                            <div class="htp-tw-desc">Fixed-aim piercing beam. Hits multiple enemies in a line. Click once to place, again to set direction.</div>
                            <div class="htp-tw-branches">‚§∑ Longline (range + pierce) ¬∑ Capacitor (massive single hit)</div>
                        </div>
                        <div class="htp-tower" style="--tw-c: var(--blue);">
                            <div class="htp-tw-name">TESLA <span class="htp-tw-cost">180g</span></div>
                            <div class="htp-tw-desc">Chain lightning arcing between nearby enemies. Strong vs clusters.</div>
                            <div class="htp-tw-branches">‚§∑ Arc Web (many chains) ¬∑ Burn (chains apply DoT)</div>
                        </div>
                        <div class="htp-tower" style="--tw-c: var(--ice);">
                            <div class="htp-tw-name">CRYO <span class="htp-tw-cost">160g</span></div>
                            <div class="htp-tw-desc">Area slow. Low damage but gives your DPS towers more time.</div>
                            <div class="htp-tw-branches">‚§∑ Deep Freeze (strong slow) ¬∑ Brittle (slowed enemies take +50% dmg)</div>
                        </div>
                        <div class="htp-tower" style="--tw-c: var(--pink);">
                            <div class="htp-tw-name">NOVA <span class="htp-tw-cost">300g</span></div>
                            <div class="htp-tw-desc">Periodic radial burst. Expensive but hits everything in range.</div>
                            <div class="htp-tw-branches">‚§∑ Shockwave (huge radius) ¬∑ Focused Core (small but devastating)</div>
                        </div>
                    </div>
                </div>

                <div class="htp-section">
                    <div class="htp-section-title">ENEMIES</div>
                    <div class="htp-enemy-list">
                        <div class="htp-enemy"><span class="htp-en-name" style="color:var(--green)">Drone</span> <span class="htp-en-wave">W1</span> ‚Äî Basic. Moderate HP and speed.</div>
                        <div class="htp-enemy"><span class="htp-en-name" style="color:#ffff3c">Swarm</span> <span class="htp-en-wave">W3</span> ‚Äî Fast, numerous, low HP. Overwhelm with quantity.</div>
                        <div class="htp-enemy"><span class="htp-en-name" style="color:var(--red)">Tank</span> <span class="htp-en-wave">W5</span> ‚Äî High HP, slow. Costs 3 lives.</div>
                        <div class="htp-enemy"><span class="htp-en-name" style="color:var(--red)">Sapper</span> <span class="htp-en-wave">W6</span> ‚Äî Shoots and damages your towers while walking. Costs 2 lives.</div>
                        <div class="htp-enemy"><span class="htp-en-name" style="color:#00c8b4">Sprinter</span> <span class="htp-en-wave">W7</span> ‚Äî Periodic bursts of very high speed.</div>
                        <div class="htp-enemy"><span class="htp-en-name" style="color:#b4b4c8">Armored</span> <span class="htp-en-wave">W8</span> ‚Äî Armor reduces damage per hit. Costs 2 lives.</div>
                        <div class="htp-enemy"><span class="htp-en-name" style="color:var(--green)">Healer</span> <span class="htp-en-wave">W11</span> ‚Äî Heals nearby enemies. Priority target! Costs 2 lives.</div>
                        <div class="htp-enemy"><span class="htp-en-name" style="color:#b464ff">Phase</span> <span class="htp-en-wave">W12</span> ‚Äî Phases in/out, taking reduced damage while phased. Costs 2 lives.</div>
                        <div class="htp-enemy"><span class="htp-en-name" style="color:var(--orange)">Splitter</span> <span class="htp-en-wave">W14</span> ‚Äî Splits into 3 shards on death.</div>
                        <div class="htp-enemy"><span class="htp-en-name" style="color:#c832ff">Boss</span> <span class="htp-en-wave">W5,10,15‚Ä¶</span> ‚Äî 4,000 HP, armored, costs 8 lives.</div>
                        <div class="htp-enemy"><span class="htp-en-name" style="color:var(--red)">Overlord</span> <span class="htp-en-wave">W28+</span> ‚Äî Mega-boss. 6,500 HP, heavy armor, costs 15 lives.</div>
                    </div>
                    <p class="htp-note">After wave 12, enemies can spawn as <span class="htp-hl-cyan">elites</span> with boosted stats and rewards.</p>
                </div>

                <div class="htp-section">
                    <div class="htp-section-title">RESEARCH</div>
                    <p>Four global research tracks in the sidebar. Each has a branching structure: two linear tiers, then a branch choice (A or B) which unlocks two final sub-specializations. You can reach 4 nodes per track. Research takes time and costs scale steeply ‚Äî plan these as long-term investments.</p>
                    <div class="htp-research-list">
                        <div class="htp-research"><span class="htp-res-icon">‚ö°</span> <strong>Damage</strong> ‚Äî +8% dmg per tier ‚Üí <em>Precision</em> (armor pierce / crits) or <em>Overload</em> (control synergy / fire rate)</div>
                        <div class="htp-research"><span class="htp-res-icon">‚óé</span> <strong>Range</strong> ‚Äî +6% range per tier ‚Üí <em>Long Optics</em> (phase counter / long-range dmg) or <em>Wide Spectrum</em> (AoE boost / proximity dmg)</div>
                        <div class="htp-research"><span class="htp-res-icon">‚ùÑ</span> <strong>Control</strong> ‚Äî +10% slow/vuln/DoT per tier ‚Üí <em>Permafrost</em> (longer slows / execute dmg) or <em>Corruption</em> (DoT spread / sapper suppression)</div>
                        <div class="htp-research"><span class="htp-res-icon">üõ°</span> <strong>Fortify</strong> ‚Äî +12% tower HP per tier ‚Üí <em>Hardened</em> (sapper resist / auto-heal) or <em>Efficiency</em> (rebuild refund / active construction)</div>
                    </div>
                </div>

                <div class="htp-section">
                    <div class="htp-section-title">SHIELDS</div>
                    <p>After specializing (branching) a tower, you can purchase a <span class="htp-hl-cyan">consumable shield</span> for it. Shields absorb incoming damage before the tower's HP is touched. If the shield is partially damaged, you can <span class="htp-hl-cyan">recharge</span> it for a prorated cost ‚Äî you only pay for the missing portion.</p>
                    <div class="htp-shield-stats">
                        <span>Shield HP: 240% of tower max HP</span>
                        <span>Full cost: 50% of gold invested in tower</span>
                        <span>Recharge cost: proportional to missing shield HP</span>
                        <span>Deploy time: 6 seconds (faster for recharge)</span>
                    </div>
                </div>

                <div class="htp-section">
                    <div class="htp-section-title">OVERCHARGE</div>
                    <p>After specializing a tower, you can <span class="htp-hl-gold">overcharge</span> it for a temporary <span class="htp-hl-gold">+25% damage boost</span> lasting 60 seconds. Overcharge costs 30% of the tower's invested gold (scaled by wave inflation), making it a significant late-game gold sink that rewards active management. You can re-apply it once it expires.</p>
                </div>

                <div class="htp-section">
                    <div class="htp-section-title">ECONOMY & STRATEGY</div>
                    <p>Gold comes from kills and wave-clear bonuses. Kill rewards decay slightly each wave (down to 50% minimum), and tower costs inflate by 2% per wave. Selling towers refunds 60% of their cost ‚Äî don't be afraid to reposition. Research can improve sell rates.</p>
                    <p>Cryo towers at path convergence points are extremely valuable since they slow enemies from all three paths. Pair with Tesla or Nova for area coverage, and use Rail towers on long straight segments. Prioritize killing Healers and watch for Sappers chewing through undefended towers. Once towers are branched, invest in shields on your most exposed positions ‚Äî they're consumable but can save a critical tower from Sapper fire.</p>
                </div>

            </div>
            <div class="htp-footer">
                <button id="btnHtpBack" class="menu-btn">‚Üê BACK TO MENU</button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê Pause Overlay ‚ïê‚ïê‚ïê -->
    <div id="pauseOverlay" class="overlay overlay-dim hidden">
        <div class="pause-box">
            <div class="pause-title">‚è∏ PAUSED</div>
            <div class="pause-keys">
                <button id="btnResume" class="menu-btn">RESUME (ESC)</button>
                <button id="btnQuit" class="menu-btn menu-btn-quit">QUIT TO MENU (Q)</button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê Game Over Overlay ‚ïê‚ïê‚ïê -->
    <div id="gameOverOverlay" class="overlay overlay-dim hidden">
        <div class="gameover-box">
            <div class="gameover-title">SYSTEM FAILURE</div>
            <div class="gameover-stats">
                <div class="go-stat"><span class="go-label">Waves</span><span id="goWaves" class="go-val">0</span></div>
                <div class="go-stat"><span class="go-label">Kills</span><span id="goKills" class="go-val">0</span></div>
                <div class="go-stat"><span class="go-label">Towers Built</span><span id="goTowers" class="go-val">0</span></div>
                <div class="go-stat"><span class="go-label">Towers Lost</span><span id="goLost" class="go-val">0</span></div>
                <div class="go-stat"><span class="go-label">Time</span><span id="goTime" class="go-val">0:00</span></div>
            </div>
            <div class="gameover-submit">
                <label class="go-name-label">Enter name for leaderboard:</label>
                <div class="go-name-row">
                    <input id="goNameInput" type="text" class="go-name-input" maxlength="20" placeholder="PLAYER" autocomplete="off">
                    <button id="btnSubmitScore" class="menu-btn">SUBMIT</button>
                </div>
                <div id="goSubmitStatus" class="go-submit-status"></div>
            </div>
            <div class="menu-divider"></div>
            <button id="btnPlayAgain" class="menu-btn pulse-btn">PLAY AGAIN</button>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê Game Container ‚ïê‚ïê‚ïê -->
    <div id="gameContainer" class="game-container hidden">
        <div id="canvasWrap" class="canvas-wrap">
            <canvas id="gameCanvas"></canvas>
            <!-- Mobile floating controls -->
            <div id="mobileControls" class="mobile-controls">
                <button id="btnMobileCancel" class="mobile-btn mobile-btn-cancel" title="Cancel / Deselect">‚úï</button>
                <button id="btnMobileSpeed" class="mobile-btn mobile-btn-speed" title="Toggle Speed">‚ñ∂‚ñ∂</button>
                <button id="btnMobilePause" class="mobile-btn mobile-btn-pause" title="Pause">‚è∏</button>
            </div>
        </div>
        <div id="drawerToggle" class="drawer-toggle">
            <span id="drawerArrow" class="drawer-arrow">‚ñ≤</span>
            <span class="drawer-label">TOWERS & INFO</span>
            <span id="drawerRes" class="drawer-res"></span>
        </div>
        <div id="sidebar" class="sidebar"></div>
    </div>

</body>
<script type="module" src="js/main.js"></script>
</html>
